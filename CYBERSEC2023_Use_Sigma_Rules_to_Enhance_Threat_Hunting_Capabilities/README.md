# CYBERLAB2023 
## Lumos! Illuminate the dark hacker attack trail use Sigma rules to enhance threat hunting capabilities

course info: https://cyber.ithome.com.tw/2023/en/lab-page/2040

---
## Resource
- slide:
    - https://speakerdeck.com/will03/lumos-illuminate-the-dark-hacker-attack-trail
- lab download: 
    - https://drive.google.com/drive/folders/11bt3NgcPedAD-StQ43FjpLYO0Zzz9e--?usp=share_link

## Course Introduction
A key rule can bring hidden attack behaviors to the surface, but writing such a rule requires a deep background knowledge of system event investigation. This course will teach students how to use SIGMA rules to identify the true attack behavior of hackers in a sea of log records, and to describe the TTPs (tactics, techniques, and procedures) of these attacks. In the course, we will delve into Sigma rules and how to collect system log files, and then explain the principles and implementation methods of various attacks, in order to consider their possible detection rules. Finally, we will collaborate to write and execute our own detection rules to judge whether malicious attack behaviors can be caught. This course allows students to experience threat hunting and try to face practical challenges.

## Course Summary
- Introduction to SIGMA rules and environment setup
- Analysis of attack methods to identify detectable keys
- Actual writing of detection rules
- Practical threat hunting
    - Hunting - Mimikatz Credentials Dump
    - Hunting - PlugX RAT Infection Technique
    - Hunting - Higaisa APT - Shortcut-Based (Lnk) Attacks

## Takeaway
- The content of the command line is rich in information but also very cluttered
- The act of deobfuscation is often more apparent to blue team
- Detection methods always depend on the event logging mechanism
- Sigma rules are widely used and powerful in the field of threat hunting